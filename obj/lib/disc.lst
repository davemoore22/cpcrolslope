                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.0 #15242 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module disc
                                      6 	
                                      7 	.optsdcc -mz80 sdcccall(1)
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _asm_fdc_on
                                     12 	.globl _asm_fdc_off
                                     13 	.globl _asm_load_file
                                     14 	.globl _a_page_disconnect_safe
                                     15 	.globl _a_page_connect_safe
                                     16 	.globl _cpct_zx7b_decrunch_s
                                     17 	.globl _cpct_pageMemory
                                     18 	.globl _d_disk_table
                                     19 	.globl _d_gfx_resources
                                     20 	.globl _d_load
                                     21 	.globl _d_gfx_resource_end
                                     22 	.globl _d_gfx_resource_start
                                     23 	.globl _d_gfx_decompress_to_screen
                                     24 	.globl _d_load_gfx_to_extended_memory
                                     25 	.globl _d_load_music
                                     26 ;--------------------------------------------------------
                                     27 ; special function registers
                                     28 ;--------------------------------------------------------
                                     29 ;--------------------------------------------------------
                                     30 ; ram data
                                     31 ;--------------------------------------------------------
                                     32 	.area _DATA
                         00008200    33 _d_disk_table	=	0x8200
                                     34 ;--------------------------------------------------------
                                     35 ; ram data
                                     36 ;--------------------------------------------------------
                                     37 	.area _INITIALIZED
                                     38 ;--------------------------------------------------------
                                     39 ; absolute external ram data
                                     40 ;--------------------------------------------------------
                                     41 	.area _DABS (ABS)
                                     42 ;--------------------------------------------------------
                                     43 ; global & static initialisations
                                     44 ;--------------------------------------------------------
                                     45 	.area _HOME
                                     46 	.area _GSINIT
                                     47 	.area _GSFINAL
                                     48 	.area _GSINIT
                                     49 ;--------------------------------------------------------
                                     50 ; Home
                                     51 ;--------------------------------------------------------
                                     52 	.area _HOME
                                     53 	.area _HOME
                                     54 ;--------------------------------------------------------
                                     55 ; code
                                     56 ;--------------------------------------------------------
                                     57 	.area _CODE
                                     58 ;src/lib/disc.c:43: void d_load(char file_name[12], u8 *loc) {
                                     59 ;	---------------------------------
                                     60 ; Function d_load
                                     61 ; ---------------------------------
    00000000                         62 _d_load::
                                     63 ;src/lib/disc.c:45: asm_fdc_on();
    00000000 E5               [11]   64 	push	hl
    00000001 D5               [11]   65 	push	de
    00000002 CDr00r00         [17]   66 	call	_asm_fdc_on
    00000005 D1               [10]   67 	pop	de
    00000006 C1               [10]   68 	pop	bc
                                     69 ;src/lib/disc.c:46: asm_load_file(file_name, loc, d_disk_table);
    00000007 21 00 82         [10]   70 	ld	hl, #_d_disk_table
    0000000A E5               [11]   71 	push	hl
    0000000B 69               [ 4]   72 	ld	l, c
    0000000C 60               [ 4]   73 	ld	h, b
    0000000D CDr00r00         [17]   74 	call	_asm_load_file
                                     75 ;src/lib/disc.c:47: asm_fdc_off();
                                     76 ;src/lib/disc.c:48: }
    00000010 C3r00r00         [10]   77 	jp	_asm_fdc_off
                                     78 	.area _CODE
                                     79 	.area _CODE
    00000013                         80 _d_gfx_resources:
    00000013 00 00                   81 	.dw #0x0000
    00000015 C3 03                   82 	.dw #0x03c3
    00000017 C3 03                   83 	.dw #0x03c3
    00000019 CA 07                   84 	.dw #0x07ca
    0000001B 8D 0B                   85 	.dw #0x0b8d
    0000001D 85 10                   86 	.dw #0x1085
    0000001F 12 1C                   87 	.dw #0x1c12
    00000021 9B 17                   88 	.dw #0x179b
                                     89 	.area _CODE
                                     90 	.area _CODE
                                     91 ;src/lib/disc.c:50: const u8 *d_gfx_resource_end(gfx_id_t id) {
                                     92 ;	---------------------------------
                                     93 ; Function d_gfx_resource_end
                                     94 ; ---------------------------------
    00000023                         95 _d_gfx_resource_end::
    00000023 6F               [ 4]   96 	ld	l, a
                                     97 ;src/lib/disc.c:52: return GFX_BANK_BASE + d_gfx_resources[id].offset +
    00000024 01r13r00         [10]   98 	ld	bc, #_d_gfx_resources+0
    00000027 26 00            [ 7]   99 	ld	h, #0x00
    00000029 29               [11]  100 	add	hl, hl
    0000002A 29               [11]  101 	add	hl, hl
    0000002B 09               [11]  102 	add	hl, bc
    0000002C 5D               [ 4]  103 	ld	e, l
    0000002D 54               [ 4]  104 	ld	d, h
    0000002E 4E               [ 7]  105 	ld	c, (hl)
    0000002F 23               [ 6]  106 	inc	hl
    00000030 46               [ 7]  107 	ld	b, (hl)
    00000031 21 01 40         [10]  108 	ld	hl, #0x4001
    00000034 09               [11]  109 	add	hl, bc
    00000035 4D               [ 4]  110 	ld	c, l
    00000036 44               [ 4]  111 	ld	b, h
                                    112 ;src/lib/disc.c:53: d_gfx_resources[id].size - 1;
    00000037 EB               [ 4]  113 	ex	de, hl
    00000038 23               [ 6]  114 	inc	hl
    00000039 23               [ 6]  115 	inc	hl
    0000003A 7E               [ 7]  116 	ld	a, (hl)
    0000003B 23               [ 6]  117 	inc	hl
    0000003C 66               [ 7]  118 	ld	h, (hl)
    0000003D 6F               [ 4]  119 	ld	l, a
    0000003E 09               [11]  120 	add	hl, bc
    0000003F EB               [ 4]  121 	ex	de, hl
    00000040 1B               [ 6]  122 	dec	de
                                    123 ;src/lib/disc.c:54: }
    00000041 C9               [10]  124 	ret
                                    125 ;src/lib/disc.c:56: const u8 *d_gfx_resource_start(gfx_id_t id) {
                                    126 ;	---------------------------------
                                    127 ; Function d_gfx_resource_start
                                    128 ; ---------------------------------
    00000042                        129 _d_gfx_resource_start::
    00000042 6F               [ 4]  130 	ld	l, a
                                    131 ;src/lib/disc.c:58: return GFX_BANK_BASE + d_gfx_resources[id].offset;
    00000043 01r13r00         [10]  132 	ld	bc, #_d_gfx_resources+0
    00000046 26 00            [ 7]  133 	ld	h, #0x00
    00000048 29               [11]  134 	add	hl, hl
    00000049 29               [11]  135 	add	hl, hl
    0000004A 09               [11]  136 	add	hl, bc
    0000004B 4E               [ 7]  137 	ld	c, (hl)
    0000004C 23               [ 6]  138 	inc	hl
    0000004D 46               [ 7]  139 	ld	b, (hl)
    0000004E 21 01 40         [10]  140 	ld	hl, #0x4001
    00000051 09               [11]  141 	add	hl, bc
    00000052 EB               [ 4]  142 	ex	de, hl
                                    143 ;src/lib/disc.c:59: }
    00000053 C9               [10]  144 	ret
                                    145 ;src/lib/disc.c:61: void d_gfx_decompress_to_screen(gfx_id_t id) {
                                    146 ;	---------------------------------
                                    147 ; Function d_gfx_decompress_to_screen
                                    148 ; ---------------------------------
    00000054                        149 _d_gfx_decompress_to_screen::
                                    150 ;src/lib/disc.c:63: const u8 *end = d_gfx_resource_end(id);
    00000054 CDr23r00         [17]  151 	call	_d_gfx_resource_end
                                    152 ;src/lib/disc.c:65: a_page_disconnect_safe();
    00000057 D5               [11]  153 	push	de
    00000058 CDr00r00         [17]  154 	call	_a_page_disconnect_safe
                                    155 ;src/lib/disc.c:66: cpct_pageMemory(RAMCFG_7 | BANK_0);
    0000005B 2E 07            [ 7]  156 	ld	l, #0x07
    0000005D CDr00r00         [17]  157 	call	_cpct_pageMemory
    00000060 D1               [10]  158 	pop	de
                                    159 ;src/lib/disc.c:67: cpct_zx7b_decrunch_s(VIDEO_MEM_END, end);
    00000061 21 FF FF         [10]  160 	ld	hl, #0xffff
    00000064 CDr00r00         [17]  161 	call	_cpct_zx7b_decrunch_s
                                    162 ;src/lib/disc.c:68: cpct_pageMemory(RAMCFG_0 | BANK_0);
    00000067 2E 00            [ 7]  163 	ld	l, #0x00
    00000069 CDr00r00         [17]  164 	call	_cpct_pageMemory
                                    165 ;src/lib/disc.c:69: a_page_connect_safe();
                                    166 ;src/lib/disc.c:70: }
    0000006C C3r00r00         [10]  167 	jp	_a_page_connect_safe
                                    168 ;src/lib/disc.c:72: void d_load_gfx_to_extended_memory(void) {
                                    169 ;	---------------------------------
                                    170 ; Function d_load_gfx_to_extended_memory
                                    171 ; ---------------------------------
    0000006F                        172 _d_load_gfx_to_extended_memory::
                                    173 ;src/lib/disc.c:74: a_page_disconnect_safe();
    0000006F CDr00r00         [17]  174 	call	_a_page_disconnect_safe
                                    175 ;src/lib/disc.c:75: cpct_pageMemory(RAMCFG_7 | BANK_0);
    00000072 2E 07            [ 7]  176 	ld	l, #0x07
    00000074 CDr00r00         [17]  177 	call	_cpct_pageMemory
                                    178 ;src/lib/disc.c:77: d_load("PRESENTSBIN", d_gfx_resource_start(GFX_PRESENTS));
    00000077 AF               [ 4]  179 	xor	a, a
    00000078 CDr42r00         [17]  180 	call	_d_gfx_resource_start
    0000007B 21rAAr00         [10]  181 	ld	hl, #___str_0
    0000007E CDr00r00         [17]  182 	call	_d_load
                                    183 ;src/lib/disc.c:78: d_load("MADEWITHBIN", d_gfx_resource_start(GFX_MADEWIDTH));
    00000081 3E 01            [ 7]  184 	ld	a, #0x01
    00000083 CDr42r00         [17]  185 	call	_d_gfx_resource_start
    00000086 21rB6r00         [10]  186 	ld	hl, #___str_1
    00000089 CDr00r00         [17]  187 	call	_d_load
                                    188 ;src/lib/disc.c:79: d_load("INTRO   BIN", d_gfx_resource_start(GFX_INTRO));
    0000008C 3E 02            [ 7]  189 	ld	a, #0x02
    0000008E CDr42r00         [17]  190 	call	_d_gfx_resource_start
    00000091 21rC2r00         [10]  191 	ld	hl, #___str_2
    00000094 CDr00r00         [17]  192 	call	_d_load
                                    193 ;src/lib/disc.c:80: d_load("TITLE   BIN", d_gfx_resource_start(GFX_TITLE));
    00000097 3E 03            [ 7]  194 	ld	a, #0x03
    00000099 CDr42r00         [17]  195 	call	_d_gfx_resource_start
    0000009C 21rCEr00         [10]  196 	ld	hl, #___str_3
    0000009F CDr00r00         [17]  197 	call	_d_load
                                    198 ;src/lib/disc.c:82: cpct_pageMemory(RAMCFG_0 | BANK_0);
    000000A2 2E 00            [ 7]  199 	ld	l, #0x00
    000000A4 CDr00r00         [17]  200 	call	_cpct_pageMemory
                                    201 ;src/lib/disc.c:83: a_page_connect_safe();
                                    202 ;src/lib/disc.c:84: }
    000000A7 C3r00r00         [10]  203 	jp	_a_page_connect_safe
                                    204 	.area _CODE
                                    205 	.area _CODE
    000000AA                        206 ___str_0:
    000000AA 50 52 45 53 45 4E 54   207 	.ascii "PRESENTSBIN"
             53 42 49 4E
    000000B5 00                     208 	.db 0x00
                                    209 	.area _CODE
                                    210 	.area _CODE
    000000B6                        211 ___str_1:
    000000B6 4D 41 44 45 57 49 54   212 	.ascii "MADEWITHBIN"
             48 42 49 4E
    000000C1 00                     213 	.db 0x00
                                    214 	.area _CODE
                                    215 	.area _CODE
    000000C2                        216 ___str_2:
    000000C2 49 4E 54 52 4F 20 20   217 	.ascii "INTRO   BIN"
             20 42 49 4E
    000000CD 00                     218 	.db 0x00
                                    219 	.area _CODE
                                    220 	.area _CODE
    000000CE                        221 ___str_3:
    000000CE 54 49 54 4C 45 20 20   222 	.ascii "TITLE   BIN"
             20 42 49 4E
    000000D9 00                     223 	.db 0x00
                                    224 	.area _CODE
                                    225 	.area _CODE
                                    226 ;src/lib/disc.c:86: void d_load_music(void) {
                                    227 ;	---------------------------------
                                    228 ; Function d_load_music
                                    229 ; ---------------------------------
    000000DA                        230 _d_load_music::
                                    231 ;src/lib/disc.c:88: a_page_disconnect_safe();
    000000DA CDr00r00         [17]  232 	call	_a_page_disconnect_safe
                                    233 ;src/lib/disc.c:89: d_load("MUSIC   BIN", MUSIC_LOC);
    000000DD 11 00 B0         [10]  234 	ld	de, #0xb000
    000000E0 21rE9r00         [10]  235 	ld	hl, #___str_4
    000000E3 CDr00r00         [17]  236 	call	_d_load
                                    237 ;src/lib/disc.c:90: a_page_connect_safe();
                                    238 ;src/lib/disc.c:91: }
    000000E6 C3r00r00         [10]  239 	jp	_a_page_connect_safe
                                    240 	.area _CODE
                                    241 	.area _CODE
    000000E9                        242 ___str_4:
    000000E9 4D 55 53 49 43 20 20   243 	.ascii "MUSIC   BIN"
             20 42 49 4E
    000000F4 00                     244 	.db 0x00
                                    245 	.area _CODE
                                    246 	.area _CODE
                                    247 	.area _CODE
                                    248 	.area _CODE
                                    249 	.area _INITIALIZER
                                    250 	.area _CABS (ABS)
